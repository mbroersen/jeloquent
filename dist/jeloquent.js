!function webpackUniversalModuleDefinition(t,r){"object"==typeof exports&&"object"==typeof module?module.exports=r():"function"==typeof define&&define.amd?define("Jeloquent",[],r):"object"==typeof exports?exports.Jeloquent=r():t.Jeloquent=r()}(self,(function(){return(()=>{"use strict";var t={486:(t,r,o)=>{function _defineProperties(t,r){for(var o=0;o<r.length;o++){var i=r[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}o.r(r),o.d(r,{BelongsTo:()=>w,Collection:()=>p,Connection:()=>k,ConnectionAdapter:()=>b,ConnectionAdapterFactory:()=>P,Database:()=>d,Field:()=>i,ForeignKey:()=>a,HasMany:()=>R,HasManyThrough:()=>l,HasOne:()=>T,HasOneThrough:()=>A,Model:()=>y,MorphOne:()=>M,MorphTo:()=>j,QueueMessage:()=>v,Relation:()=>u,Store:()=>S,Table:()=>h});var i=function(){function Field(t,r){!function _classCallCheck(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}(this,Field),this.isPrimary=null!=r&&r,this.$name=t,this.$fieldValue=null,this.$previousValue=void 0,this.$originalValue=void 0,this.$parent=null}return function _createClass(t,r,o){return r&&_defineProperties(t.prototype,r),o&&_defineProperties(t,o),t}(Field,[{key:"setName",value:function setName(){return this}},{key:"setup",value:function setup(t){return this.$parent=t,this.setName().setParentProperties()}},{key:"tableSetup",value:function tableSetup(){}},{key:"addParentFieldValueLookUp",value:function addParentFieldValueLookUp(){var t=this;Object.defineProperty(this.$parent,this.$name,{get:function get(){return t.value},set:function set(r){var o,i;void 0===t.$previousValue&&(t.$previousValue=JSON.parse(JSON.stringify(null!==(o=t.value)&&void 0!==o?o:r)));void 0===t.$originalValue&&(t.$originalValue=JSON.parse(JSON.stringify(null!==(i=t.value)&&void 0!==i?i:r)));t.$previousValue=JSON.parse(JSON.stringify(t.value)),t.value=r}})}},{key:"addParentOriginalValueLookUp",value:function addParentOriginalValueLookUp(){var t=this;Object.defineProperty(this.$parent,"original_".concat(this.$name),{get:function get(){return t.originalValue}})}},{key:"setParentProperties",value:function setParentProperties(){return this.addParentFieldValueLookUp(),this.addParentOriginalValueLookUp(),this.setFillPropertyOnParent(),this}},{key:"setFillPropertyOnParent",value:function setFillPropertyOnParent(){var t=this;Object.defineProperty(this.$parent,"_".concat(this.$name),{set:function set(r){void 0===t.$originalValue&&(t.$originalValue=JSON.parse(JSON.stringify(t.value))),t.$previousValue=JSON.parse(JSON.stringify(t.value)),t.$fieldValue=r}})}},{key:"resetDirty",value:function resetDirty(){this.$originalValue=JSON.parse(JSON.stringify(this.$fieldValue)),this.$previousValue=JSON.parse(JSON.stringify(this.$fieldValue))}},{key:"toJson",value:function toJson(){var t={};return t[this.$name]=this.value,JSON.parse(JSON.stringify(t))}},{key:"isDirty",get:function get(){return this.$fieldValue!=this.$previousValue}},{key:"originalValue",get:function get(){return this.$originalValue}},{key:"previousValue",get:function get(){return this.$previousValue}},{key:"value",get:function get(){return this.$fieldValue},set:function set(t){this.$fieldValue=t}}]),Field}();function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(t){return typeof t}:function _typeof(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ForeignKey_defineProperties(t,r){for(var o=0;o<r.length;o++){var i=r[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function _setPrototypeOf(t,r){return(_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(t,r){return t.__proto__=r,t})(t,r)}function _createSuper(t){var r=function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var o,i=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;o=Reflect.construct(i,arguments,a)}else o=i.apply(this,arguments);return _possibleConstructorReturn(this,o)}}function _possibleConstructorReturn(t,r){return!r||"object"!==_typeof(r)&&"function"!=typeof r?function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):r}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var a=function(t){!function _inherits(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),r&&_setPrototypeOf(t,r)}(ForeignKey,t);var r=_createSuper(ForeignKey);function ForeignKey(t,o){var i;return function ForeignKey_classCallCheck(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}(this,ForeignKey),(i=r.call(this,t)).foreignKey=null!=t?t:o,i}return function ForeignKey_createClass(t,r,o){return r&&ForeignKey_defineProperties(t.prototype,r),o&&ForeignKey_defineProperties(t,o),t}(ForeignKey,[{key:"setRelation",value:function setRelation(t){return this.relation=t,this}},{key:"tableSetup",value:function tableSetup(t){t.registerIndex(this.foreignKey)}},{key:"value",get:function get(){return this.$fieldValue},set:function set(t){this.$fieldValue=t}}]),ForeignKey}(i);function Relation_typeof(t){return(Relation_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(t){return typeof t}:function _typeof(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Relation_defineProperties(t,r){for(var o=0;o<r.length;o++){var i=r[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Relation_setPrototypeOf(t,r){return(Relation_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(t,r){return t.__proto__=r,t})(t,r)}function Relation_createSuper(t){var r=function Relation_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var o,i=Relation_getPrototypeOf(t);if(r){var a=Relation_getPrototypeOf(this).constructor;o=Reflect.construct(i,arguments,a)}else o=i.apply(this,arguments);return Relation_possibleConstructorReturn(this,o)}}function Relation_possibleConstructorReturn(t,r){return!r||"object"!==Relation_typeof(r)&&"function"!=typeof r?function Relation_assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):r}function Relation_getPrototypeOf(t){return(Relation_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var u=function(t){!function Relation_inherits(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),r&&Relation_setPrototypeOf(t,r)}(Relation,t);var r=Relation_createSuper(Relation);function Relation(t,o,i){var a;!function Relation_classCallCheck(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}(this,Relation);var u=null!=i?i:t.snakeCaseClassName;return(a=r.call(this,u)).model=t,a.foreignKey=o,a}return function Relation_createClass(t,r,o){return r&&Relation_defineProperties(t.prototype,r),o&&Relation_defineProperties(t,o),t}(Relation,[{key:"tableSetup",value:function tableSetup(t){t.registerIndex(this.foreignKey)}},{key:"getRelationalFields",value:function getRelationalFields(){return[new a(this.foreignKey).setRelation(this)]}},{key:"setFillPropertyOnParent",value:function setFillPropertyOnParent(){var t=this;Object.defineProperty(this.$parent,"_".concat(this.$name),{set:function set(r){Array.isArray(r)||(r=[r]),r.forEach((function(r){t.model.ids().includes(r.id)||t.model.insert(r)}))}})}}]),Relation}(i);function HasManyThrough_typeof(t){return(HasManyThrough_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(t){return typeof t}:function _typeof(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _toConsumableArray(t){return function _arrayWithoutHoles(t){if(Array.isArray(t))return _arrayLikeToArray(t)}(t)||function _iterableToArray(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function _unsupportedIterableToArray(t,r){if(!t)return;if("string"==typeof t)return _arrayLikeToArray(t,r);var o=Object.prototype.toString.call(t).slice(8,-1);"Object"===o&&t.constructor&&(o=t.constructor.name);if("Map"===o||"Set"===o)return Array.from(t);if("Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o))return _arrayLikeToArray(t,r)}(t)||function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(t,r){(null==r||r>t.length)&&(r=t.length);for(var o=0,i=new Array(r);o<r;o++)i[o]=t[o];return i}function HasManyThrough_defineProperties(t,r){for(var o=0;o<r.length;o++){var i=r[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function HasManyThrough_setPrototypeOf(t,r){return(HasManyThrough_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(t,r){return t.__proto__=r,t})(t,r)}function HasManyThrough_createSuper(t){var r=function HasManyThrough_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var o,i=HasManyThrough_getPrototypeOf(t);if(r){var a=HasManyThrough_getPrototypeOf(this).constructor;o=Reflect.construct(i,arguments,a)}else o=i.apply(this,arguments);return HasManyThrough_possibleConstructorReturn(this,o)}}function HasManyThrough_possibleConstructorReturn(t,r){return!r||"object"!==HasManyThrough_typeof(r)&&"function"!=typeof r?function HasManyThrough_assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):r}function HasManyThrough_getPrototypeOf(t){return(HasManyThrough_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var l=function(t){!function HasManyThrough_inherits(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),r&&HasManyThrough_setPrototypeOf(t,r)}(HasManyThrough,t);var r=HasManyThrough_createSuper(HasManyThrough);function HasManyThrough(t,o,i,a){var u;return function HasManyThrough_classCallCheck(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}(this,HasManyThrough),(u=r.call(this,t,i)).model=t,u.throughModel=o,u.localKey=null!=a?a:"id",u}return function HasManyThrough_createClass(t,r,o){return r&&HasManyThrough_defineProperties(t.prototype,r),o&&HasManyThrough_defineProperties(t,o),t}(HasManyThrough,[{key:"getValueByParentKey",value:function getValueByParentKey(t){var r,o,i=this.model.getIndexByKey(this.indexName);return globalThis.Store.database().find(this.model.className,_toConsumableArray(null!==(r=null===(o=i.get(this.$parent[t]))||void 0===o?void 0:o.values())&&void 0!==r?r:[]))}},{key:"setName",value:function setName(){return this._lcThroughModelClassName=this.throughModel.snakeCaseClassName,this._lcModelClassName=this.model.snakeCaseClassName,this._lcParentClassName=this.$parent.snakeCaseClassName,this.foreignKey="".concat(this._lcThroughModelClassName,"_id"),this.$name="".concat(this._lcModelClassName,"s"),this}},{key:"tableSetup",value:function tableSetup(){this.model.registerIndex(this.indexName)}},{key:"getRelationalFields",value:function getRelationalFields(){return[]}},{key:"indexName",get:function get(){return"".concat(this._lcThroughModelClassName,".").concat(this._lcParentClassName,"_id")}},{key:"value",get:function get(){return this.getValueByParentKey("primaryKey")}},{key:"originalValue",get:function get(){return this.getValueByParentKey("originalPrimaryKey")}}]),HasManyThrough}(u);function _slicedToArray(t,r){return function _arrayWithHoles(t){if(Array.isArray(t))return t}(t)||function _iterableToArrayLimit(t,r){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var o=[],i=!0,a=!1,u=void 0;try{for(var l,c=t[Symbol.iterator]();!(i=(l=c.next()).done)&&(o.push(l.value),!r||o.length!==r);i=!0);}catch(t){a=!0,u=t}finally{try{i||null==c.return||c.return()}finally{if(a)throw u}}return o}(t,r)||Index_unsupportedIterableToArray(t,r)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _createForOfIteratorHelper(t,r){var o;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(o=Index_unsupportedIterableToArray(t))||r&&t&&"number"==typeof t.length){o&&(t=o);var i=0,a=function F(){};return{s:a,n:function n(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function e(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var u,l=!0,c=!1;return{s:function s(){o=t[Symbol.iterator]()},n:function n(){var t=o.next();return l=t.done,t},e:function e(t){c=!0,u=t},f:function f(){try{l||null==o.return||o.return()}finally{if(c)throw u}}}}function Index_unsupportedIterableToArray(t,r){if(t){if("string"==typeof t)return Index_arrayLikeToArray(t,r);var o=Object.prototype.toString.call(t).slice(8,-1);return"Object"===o&&t.constructor&&(o=t.constructor.name),"Map"===o||"Set"===o?Array.from(t):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?Index_arrayLikeToArray(t,r):void 0}}function Index_arrayLikeToArray(t,r){(null==r||r>t.length)&&(r=t.length);for(var o=0,i=new Array(r);o<r;o++)i[o]=t[o];return i}function Index_defineProperties(t,r){for(var o=0;o<r.length;o++){var i=r[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var c=function(){function Index(){!function Index_classCallCheck(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}(this,Index),this.indexes=new Map,this.indexedFields=new Set,this.splittedIndexNames=new Map}return function Index_createClass(t,r,o){return r&&Index_defineProperties(t.prototype,r),o&&Index_defineProperties(t,o),t}(Index,[{key:"getIndexByKey",value:function getIndexByKey(t){return this.indexes.get(t)}},{key:"registerIndex",value:function registerIndex(t){this.indexes.has(t)||(this.indexedFields.add(t),this.splittedIndexNames.set(t,t.split(".")),this.indexes.set(t,new Map))}},{key:"addValue",value:function addValue(t,r,o){var i,a;if(this.indexes.has(t)&&null!==o){var u=null===(i=this.indexes)||void 0===i?void 0:i.get(t);u.has(r)?(u=null===(a=u)||void 0===a?void 0:a.get(r)).has(o)||u.add(o):this.registerLookUpKey(t,r,o)}}},{key:"removeValue",value:function removeValue(t,r,o){var i,a,u;null===(i=this.indexes)||void 0===i||null===(a=i.get(t))||void 0===a||null===(u=a.get(r))||void 0===u||u.delete(o)}},{key:"registerLookUpKey",value:function registerLookUpKey(t,r,o){var i,a;null===(i=this.indexes)||void 0===i||null===(a=i.get(t))||void 0===a||a.set(r,new Set([o]))}},{key:"unregisterLookUpKey",value:function unregisterLookUpKey(t,r){var o,i;null===(o=this.indexes)||void 0===o||null===(i=o.get(t))||void 0===i||i.delete(r)}},{key:"getLookUpValue",value:function getLookUpValue(t,r){var o,i,a=t,u=_createForOfIteratorHelper(this.splittedIndexNames.get(r));try{for(u.s();!(i=u.n()).done;){var l=i.value;if(null===a["original_".concat(l)])break;a=a["original_".concat(l)]}}catch(t){u.e(t)}finally{u.f()}return null!==(o=a)&&void 0!==o?o:null}},{key:"addValueByModel",value:function addValueByModel(t){var r,o=_createForOfIteratorHelper(this.indexes);try{for(o.s();!(r=o.n()).done;){var i=_slicedToArray(r.value,1)[0];this.addValue(i,this.getLookUpValue(t,i),t.primaryKey)}}catch(t){o.e(t)}finally{o.f()}}},{key:"removeValueByModel",value:function removeValueByModel(t){var r,o=_createForOfIteratorHelper(this.indexes);try{for(o.s();!(r=o.n()).done;){var i=_slicedToArray(r.value,1)[0];this.removeValue(i,this.getLookUpValue(t,i),t.primaryKey)}}catch(t){o.e(t)}finally{o.f()}}},{key:"truncate",value:function truncate(){for(var t in this.indexes)this.indexes.get(t).clear()}}],[{key:"registerIndex",value:function registerIndex(t,r){globalThis.Store.database().registerIndex(t.className,r)}},{key:"addIndex",value:function addIndex(t,r){globalThis.Store.database().addIndex(t.className,r.foreignKey,r.fieldValue,t.primaryKey)}},{key:"removeIndex",value:function removeIndex(t,r){globalThis.Store.database().removeIndex(t.className,r.foreignKey,r.previousValue,t.primaryKey)}},{key:"removeTmpIdFromIndex",value:function removeTmpIdFromIndex(t){var r=t.className;t.dirtyFields.filter((function(t){return t instanceof a})).forEach((function(o){globalThis.Store.database().removeIndex(r,o.$name,o.originalValue,t._tmpId)}))}}]),Index}();function ownKeys(t,r){var o=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);r&&(i=i.filter((function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable}))),o.push.apply(o,i)}return o}function _defineProperty(t,r,o){return r in t?Object.defineProperty(t,r,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[r]=o,t}function Model_toConsumableArray(t){return function Model_arrayWithoutHoles(t){if(Array.isArray(t))return Model_arrayLikeToArray(t)}(t)||function Model_iterableToArray(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function Model_unsupportedIterableToArray(t,r){if(!t)return;if("string"==typeof t)return Model_arrayLikeToArray(t,r);var o=Object.prototype.toString.call(t).slice(8,-1);"Object"===o&&t.constructor&&(o=t.constructor.name);if("Map"===o||"Set"===o)return Array.from(t);if("Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o))return Model_arrayLikeToArray(t,r)}(t)||function Model_nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Model_arrayLikeToArray(t,r){(null==r||r>t.length)&&(r=t.length);for(var o=0,i=new Array(r);o<r;o++)i[o]=t[o];return i}function Model_defineProperties(t,r){for(var o=0;o<r.length;o++){var i=r[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var y=function(){function Model(t){!function Model_classCallCheck(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}(this,Model),this.setFields(this.addRelationFields(t)),this._tmpId="_".concat(++globalThis.Store.numberOfModelCreated)}return function Model_createClass(t,r,o){return r&&Model_defineProperties(t.prototype,r),o&&Model_defineProperties(t,o),t}(Model,[{key:"tableSetup",value:function tableSetup(t){for(var r=0;r<this.numberOfFields;r++)this.originalFields[r]instanceof a&&this.originalFields[r].tableSetup(t),this.originalFields[r]instanceof l&&this.originalFields[r].tableSetup(t)}},{key:"isDirty",value:function isDirty(t){return t?this.dirtyFieldNames.includes(t):this.dirtyFields.length>0}},{key:"resetDirty",value:function resetDirty(){this.originalFields.filter((function(t){return!(t instanceof u)})).forEach((function(t){t.resetDirty()}))}},{key:"delete",value:function _delete(){this.constructor.delete(this.primaryKey)}},{key:"save",value:function save(){var t=this.className,r=globalThis.Store.database(),o=r.ids(t);"_"!==this.primaryKey[0]&&o.includes(this._tmpId)&&(c.removeTmpIdFromIndex(this),r.delete(t,this._tmpId)),o.includes(this.primaryKey)?r.update(t,this):r.insert(t,this)}},{key:"registerIndex",value:function registerIndex(t){c.registerIndex(this,t)}},{key:"fill",value:function fill(t){for(var r=0;r<this.numberOfFields;r++)if(!(this.originalFields[r]instanceof u)){var o=this.originalFields[r].$name;void 0!==t[o]&&(this["_".concat(o)]=t[o])}}},{key:"fillRelations",value:function fillRelations(t){for(var r=0;r<this.numberOfFields;r++)if(this.originalFields[r]instanceof u){var o=this.originalFields[r].$name;void 0!==t[o]&&(this["_".concat(o)]=t[o])}}},{key:"addRelationFields",value:function addRelationFields(t){var r=Model_toConsumableArray(t);return t.forEach((function(t,o){t instanceof u&&r.splice.apply(r,[o,0].concat(Model_toConsumableArray(t.getRelationalFields())))})),this.numberOfFields=r.length,r}},{key:"setFields",value:function setFields(t){var r=this;this.originalFields=Model_toConsumableArray(t),this.numberOfFields=this.originalFields.length;for(var o=0;o<this.numberOfFields;o++)this.originalFields[o].setup(this);return Object.defineProperty(this,"indexedFields",{get:function get(){return r.originalFields.filter((function(t){return t instanceof a})).reduce((function(t,r){return t.add(r.$name),t}),new Set)}}),this.primaryFields=this.originalFields.filter((function(t){return t.isPrimary})),this}},{key:"toJson",value:function toJson(t){for(var r={},o=0;o<this.originalFields.length;o++){var i=this.originalFields[o];i instanceof u&&t||(r[i.$name]=i.value,r[i.$name]instanceof Model?r[i.$name]=r[i.$name].toJson(!0):r[i.$name]instanceof Array&&(r[i.$name]=Model_toConsumableArray(r[i.$name].map((function(t){var r;return null!==(r=null==t?void 0:t.toJson(!0))&&void 0!==r?r:t})))))}return function _objectSpread(t){for(var r=1;r<arguments.length;r++){var o=null!=arguments[r]?arguments[r]:{};r%2?ownKeys(Object(o),!0).forEach((function(r){_defineProperty(t,r,o[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):ownKeys(Object(o)).forEach((function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(o,r))}))}return t}({},r)}},{key:"className",get:function get(){return this.constructor.className}},{key:"primaryKey",get:function get(){var t,r;return null!==(t=null!==(r=this.primaryFields.reduce((function(t,r,o){return o>0?"".concat(t,"-").concat(r.value):r.value}),""))&&void 0!==r?r:this._tmpId)&&void 0!==t?t:null}},{key:"originalPrimaryKey",get:function get(){var t,r;return null!==(t=null!==(r=this.primaryFields.reduce((function(t,r,o){return o>0?"".concat(t,"-").concat(r.originalValue):r.originalValue}),""))&&void 0!==r?r:this._tmpId)&&void 0!==t?t:null}},{key:"primaryKeyName",get:function get(){return this.originalFields.filter((function(t){return t.isPrimary})).map((function(t){return t.$name}))}},{key:"originalValues",get:function get(){return this.originalFields.reduce((function(t,r){return void 0!==r.originalValue&&(t[r.$name]=r.originalValue),t}),{})}},{key:"dirtyFields",get:function get(){return this.originalFields.filter((function(t){return t.isDirty}))}},{key:"dirtyFieldNames",get:function get(){return this.dirtyFields.map((function(t){return t.$name}))}},{key:"snakeCaseClassName",get:function get(){return this.constructor.snakeCaseClassName}},{key:"kebabCaseClassName",get:function get(){return this.constructor.kebabCaseClassName}}],[{key:"getInstance",value:function getInstance(){var t,r=null!==(t=globalThis.Store.classInstances[this.className])&&void 0!==t?t:globalThis.Store.classInstances[this.className]=new this,o=r.originalFields.reduce((function(t,r){return t.push(Object.assign(Object.create(Object.getPrototypeOf(r)),r)),t}),[]);return Object.create(Object.getPrototypeOf(r)).setFields(o)}},{key:"registerIndex",value:function registerIndex(t){c.registerIndex(this.getInstance(),t)}},{key:"getIndexByKey",value:function getIndexByKey(t){var r=this.className;return globalThis.Store.database().getIndexByKey(r,t)}},{key:"aSyncInsert",value:function aSyncInsert(t){var r=this;return new Promise((function(o){requestAnimationFrame((function(){o(r.insert(t))}))}))}},{key:"insert",value:function insert(t){for(var r=(t=Array.isArray(t)?t:[t]).length,o=0;o<r;o++){var i=t[o],a=this.getInstance();a.fill(i),globalThis.Store.database().insert(this.className,a),a.fillRelations(i),t[o]=a}return t}},{key:"update",value:function update(t){var r=new this;return r.fill(t),globalThis.Store.database().update(this.className,r),r}},{key:"delete",value:function _delete(t){globalThis.Store.database().delete(this.className,t)}},{key:"find",value:function find(t){return globalThis.Store.database().find(this.className,t)}},{key:"select",value:function select(t){try{return globalThis.Store.database().select(this.className,t)}catch(t){console.error(t)}}},{key:"all",value:function all(){return globalThis.Store.database().all(this.className)}},{key:"ids",value:function ids(){return globalThis.Store.database().ids(this.className)}},{key:"snakeCaseClassName",get:function get(){return this.snakeCaseName||(this.snakeCaseName=this.name[0].toLowerCase()+this.name.slice(1).replace(/([A-Z])/g,"_$1").toLowerCase()),this.snakeCaseName}},{key:"kebabCaseClassName",get:function get(){return this.kebabCaseName||(this.kebabCaseName=this.name[0].toLowerCase()+this.name.slice(1).replace(/([A-Z])/g,"-$1").toLowerCase()),this.kebabCaseName}},{key:"className",get:function get(){return this.name}}]),Model}();function Collection_typeof(t){return(Collection_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(t){return typeof t}:function _typeof(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Collection_toConsumableArray(t){return function Collection_arrayWithoutHoles(t){if(Array.isArray(t))return Collection_arrayLikeToArray(t)}(t)||function Collection_iterableToArray(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function Collection_unsupportedIterableToArray(t,r){if(!t)return;if("string"==typeof t)return Collection_arrayLikeToArray(t,r);var o=Object.prototype.toString.call(t).slice(8,-1);"Object"===o&&t.constructor&&(o=t.constructor.name);if("Map"===o||"Set"===o)return Array.from(t);if("Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o))return Collection_arrayLikeToArray(t,r)}(t)||function Collection_nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Collection_arrayLikeToArray(t,r){(null==r||r>t.length)&&(r=t.length);for(var o=0,i=new Array(r);o<r;o++)i[o]=t[o];return i}function Collection_classCallCheck(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function Collection_defineProperties(t,r){for(var o=0;o<r.length;o++){var i=r[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Collection_possibleConstructorReturn(t,r){return!r||"object"!==Collection_typeof(r)&&"function"!=typeof r?function Collection_assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):r}function _wrapNativeSuper(t){var r="function"==typeof Map?new Map:void 0;return(_wrapNativeSuper=function _wrapNativeSuper(t){if(null===t||!function _isNativeFunction(t){return-1!==Function.toString.call(t).indexOf("[native code]")}(t))return t;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==r){if(r.has(t))return r.get(t);r.set(t,Wrapper)}function Wrapper(){return _construct(t,arguments,Collection_getPrototypeOf(this).constructor)}return Wrapper.prototype=Object.create(t.prototype,{constructor:{value:Wrapper,enumerable:!1,writable:!0,configurable:!0}}),Collection_setPrototypeOf(Wrapper,t)})(t)}function _construct(t,r,o){return(_construct=Collection_isNativeReflectConstruct()?Reflect.construct:function _construct(t,r,o){var i=[null];i.push.apply(i,r);var a=new(Function.bind.apply(t,i));return o&&Collection_setPrototypeOf(a,o.prototype),a}).apply(null,arguments)}function Collection_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function Collection_setPrototypeOf(t,r){return(Collection_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(t,r){return t.__proto__=r,t})(t,r)}function Collection_getPrototypeOf(t){return(Collection_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var p=function(t){!function Collection_inherits(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),r&&Collection_setPrototypeOf(t,r)}(Collection,t);var r=function Collection_createSuper(t){var r=Collection_isNativeReflectConstruct();return function _createSuperInternal(){var o,i=Collection_getPrototypeOf(t);if(r){var a=Collection_getPrototypeOf(this).constructor;o=Reflect.construct(i,arguments,a)}else o=i.apply(this,arguments);return Collection_possibleConstructorReturn(this,o)}}(Collection);function Collection(){Collection_classCallCheck(this,Collection);for(var t=arguments.length,o=new Array(t),i=0;i<t;i++)o[i]=arguments[i];return r.call.apply(r,[this].concat(o))}return function Collection_createClass(t,r,o){return r&&Collection_defineProperties(t.prototype,r),o&&Collection_defineProperties(t,o),t}(Collection,[{key:"_getRowFieldResult",value:function _getRowFieldResult(t,r){for(var o,i=null!==(o=t[r[0]])&&void 0!==o?o:null,a=1;a<r.length;a++){var u,l=r[a];if(null===i)break;if(i instanceof Collection)return i.pluck(r[a]);i=null!==(u=i[l])&&void 0!==u?u:null}return i}},{key:"pluck",value:function pluck(t,r){var o=t.split(".");if(r){var i=r.split("."),a={};for(var u in this)a[this._getRowFieldResult(this[u],i)]=this._getRowFieldResult(this[u],o);return a}var l=[];for(var c in this)l.push(this._getRowFieldResult(this[c],o));return l}},{key:"first",value:function first(){var t;return null!==(t=this[0])&&void 0!==t?t:null}},{key:"last",value:function last(){var t;return null!==(t=this.slice(-1)[0])&&void 0!==t?t:null}},{key:"merge",value:function merge(t){return this.push.apply(this,Collection_toConsumableArray(t)),this}},{key:"random",value:function random(){return this[Math.round((this.length-1)*Math.random())]}},{key:"unique",value:function unique(t){var unique={};for(var r in this)unique[this[r][t]]=this[r];return _construct(Collection,Collection_toConsumableArray(Object.values(unique)))}},{key:"whereIfFunction",value:function whereIfFunction(t,r){var o=new Collection;for(var i in this)r(t,this[i])&&o.push(this[i]);return o}},{key:"where",value:function where(t,r,o){var i;o=null!==(i=o)&&void 0!==i?i:r,r=r===o?"==":r;var a={">":function _(t,r){return t>r},">=":function _(t,r){return t>=r},"<":function _(t,r){return t<r},"<=":function _(t,r){return t<=r},"!=":function _(t,r){return t!=r},"==":function _(t,r){return t==r}};if(!Object.prototype.hasOwnProperty.call(a,r))throw new Error("Invalid comparison operator used");return this.whereIfFunction(t,(function(t,i){return a[r](i[t],o)}))}},{key:"whereBetween",value:function whereBetween(t,r){return this.whereIfFunction(t,(function(t,o){var i=o[t];return i>=r[0]&&i<=r[1]}))}},{key:"whereNotBetween",value:function whereNotBetween(t,r){return this.whereIfFunction(t,(function(t,o){var i=o[t];return!(i>=r[0]&&i<=r[1])}))}},{key:"whereNull",value:function whereNull(t){return this.whereIfFunction(t,(function(t,r){return null===r[t]}))}},{key:"whereNotNull",value:function whereNotNull(t){return this.whereIfFunction(t,(function(t,r){return null!==r[t]}))}},{key:"whereIn",value:function whereIn(t,r){return this.whereIfFunction(t,(function(t,o){return r.includes(o[t])}))}},{key:"whereNotIn",value:function whereNotIn(t,r){return this.whereIfFunction(t,(function(t,o){return!r.includes(o[t])}))}},{key:"whereInstanceOf",value:function whereInstanceOf(t){return this.whereIfFunction(null,(function(r,o){return o instanceof t}))}},{key:"whereNotInstanceOf",value:function whereNotInstanceOf(t){return this.whereIfFunction(null,(function(r,o){return!(o instanceof t)}))}}]),Collection}(_wrapNativeSuper(Array));function Table_construct(t,r,o){return(Table_construct=Table_isNativeReflectConstruct()?Reflect.construct:function _construct(t,r,o){var i=[null];i.push.apply(i,r);var a=new(Function.bind.apply(t,i));return o&&Table_setPrototypeOf(a,o.prototype),a}).apply(null,arguments)}function Table_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function Table_setPrototypeOf(t,r){return(Table_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(t,r){return t.__proto__=r,t})(t,r)}function Table_toConsumableArray(t){return function Table_arrayWithoutHoles(t){if(Array.isArray(t))return Table_arrayLikeToArray(t)}(t)||function Table_iterableToArray(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function Table_unsupportedIterableToArray(t,r){if(!t)return;if("string"==typeof t)return Table_arrayLikeToArray(t,r);var o=Object.prototype.toString.call(t).slice(8,-1);"Object"===o&&t.constructor&&(o=t.constructor.name);if("Map"===o||"Set"===o)return Array.from(t);if("Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o))return Table_arrayLikeToArray(t,r)}(t)||function Table_nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Table_arrayLikeToArray(t,r){(null==r||r>t.length)&&(r=t.length);for(var o=0,i=new Array(r);o<r;o++)i[o]=t[o];return i}function Table_defineProperties(t,r){for(var o=0;o<r.length;o++){var i=r[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var h=function(){function Table(t){!function Table_classCallCheck(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}(this,Table),this.setup(t.getInstance())}return function Table_createClass(t,r,o){return r&&Table_defineProperties(t.prototype,r),o&&Table_defineProperties(t,o),t}(Table,[{key:"setup",value:function setup(t){this.model=t,this.name=t.className,this.models=new Map,this.index=new c,this.primaryKeyFieldNames=t.primaryKeyName}},{key:"setupIndexes",value:function setupIndexes(){this.model.tableSetup(this)}},{key:"registerIndex",value:function registerIndex(t){this.index.registerIndex(t)}},{key:"addIndex",value:function addIndex(t,r,o){this.index.addValue(t,r,o)}},{key:"removeIndex",value:function removeIndex(t,r,o){this.index.removeValue(t,r,o)}},{key:"getIndexByKey",value:function getIndexByKey(t){return this.index.getIndexByKey(t)}},{key:"allModels",value:function allModels(){return this.models}},{key:"ids",value:function ids(){return Table_toConsumableArray(this.models.keys())}},{key:"all",value:function all(){for(var t=Table_toConsumableArray(this.models.values()),r=t.length,o=new p,i=0;i<r;i+=1e4)o.push.apply(o,Table_toConsumableArray(t.slice(i,i+1e4)));return o}},{key:"insert",value:function insert(t){if(this.models.has(t.primaryKey))throw new Error("Record already exists");if(!(t instanceof y))throw new Error("Record should be instance of model");t.resetDirty(),null!=t.primaryKey&&this.models.set(t.primaryKey,t),this.index.addValueByModel(t)}},{key:"update",value:function update(t){if(!this.models.has(t.primaryKey))throw new Error("Record doesn't exists");if(!(t instanceof y))throw new Error("Record should be instance of model");this.index.removeValueByModel(t),t.resetDirty(),this.index.addValueByModel(t),this.models.set(t.primaryKey,t)}},{key:"delete",value:function _delete(t){if(!this.models.has(t))throw new Error("Record doesn't exists");this.index.removeValueByModel(this.find(t)),this.models.delete(t)}},{key:"truncate",value:function truncate(){this.models.clear(),this.index.truncate()}},{key:"getKey",value:function getKey(t){if("string"==typeof t)return t;if(null===t)return null;for(var r=[],o=0;o<this.primaryKeyFieldNames.length;o++){var i;r.push(null!==(i=t[this.primaryKeyFieldNames[o]])&&void 0!==i?i:"")}return r.join("-")}},{key:"find",value:function find(t){var r,o,i=this,a=this.primaryKeyFieldNames.length>1;if(Array.isArray(t)){for(var u=[],l=a?function(r){var o;u.push(null!==(o=i.models.get(i.getKey(t[r])))&&void 0!==o?o:null)}:function(r){var o;u.push(null!==(o=i.models.get(t[r]))&&void 0!==o?o:null)},c=0;c<t.length;c++)l(c);return Table_construct(p,u)}return a?null!==(o=this.models.get(this.getKey(t)))&&void 0!==o?o:null:null!==(r=this.models.get(t))&&void 0!==r?r:null}},{key:"select",value:function select(t){if(!this.models.has(t))throw new Error("Record doesn't exists");return this.find(t)}},{key:"indexes",get:function get(){return this.index.indexes}}]),Table}();function Database_defineProperties(t,r){for(var o=0;o<r.length;o++){var i=r[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var d=function(){function Database(t,r){var o=this;!function Database_classCallCheck(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}(this,Database),this.name=t,this.tables={},r.forEach((function(t){var r=new h(t);o.tables[r.name]=r}))}return function Database_createClass(t,r,o){return r&&Database_defineProperties(t.prototype,r),o&&Database_defineProperties(t,o),t}(Database,[{key:"setIndexes",value:function setIndexes(){Object.values(this.tables).forEach((function(t){t.setupIndexes()}))}},{key:"showTables",value:function showTables(){return Object.keys(this.tables)}},{key:"ids",value:function ids(t){return this.tables[t].ids()}},{key:"all",value:function all(t){return this.tables[t].all()}},{key:"allModels",value:function allModels(t){return this.tables[t].allModels()}},{key:"registerIndex",value:function registerIndex(t,r){this.tables[t].registerIndex(r)}},{key:"addIndex",value:function addIndex(t,r,o,i){return this.tables[t].addIndex(r,o,i)}},{key:"removeIndex",value:function removeIndex(t,r,o,i){return this.tables[t].removeIndex(r,o,i)}},{key:"getIndexByKey",value:function getIndexByKey(t,r){return this.tables[t].getIndexByKey(r)}},{key:"unregisterLookUpKey",value:function unregisterLookUpKey(t,r,o){this.tables[t].unregisterLookUpKey(r,o)}},{key:"indexes",value:function indexes(t){return this.tables[t].indexes}},{key:"insert",value:function insert(t,r){return this.tables[t].insert(r)}},{key:"update",value:function update(t,r){return this.tables[t].update(r)}},{key:"find",value:function find(t,r){return this.tables[t].find(r)}},{key:"select",value:function select(t,r){return this.tables[t].select(r)}},{key:"delete",value:function _delete(t,r){return this.tables[t].delete(r)}},{key:"drop",value:function drop(t){delete this.tables[t]}},{key:"truncate",value:function truncate(t){return this.tables[t].truncate()}},{key:"query",value:function query(t){var r=t.match(/^((SELECT)|(INSERT)|(DELETE))\s+(.*)\s+FROM\s+([^\s]+)(\s+WHERE\s+([^\s]+)\s+(=)\s+([^\s+]))?((\s+)|;)?$/i);if(0===r.length)return null;var o=r[1],i=r[6],a=r[8],u=r[10];return"id"===a?this[o.toLowerCase()](i,u):void 0===a&&"SELECT"===o?this.all(i):null}}]),Database}();function ConnectionSettings_ownKeys(t,r){var o=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);r&&(i=i.filter((function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable}))),o.push.apply(o,i)}return o}function ConnectionSettings_objectSpread(t){for(var r=1;r<arguments.length;r++){var o=null!=arguments[r]?arguments[r]:{};r%2?ConnectionSettings_ownKeys(Object(o),!0).forEach((function(r){ConnectionSettings_defineProperty(t,r,o[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):ConnectionSettings_ownKeys(Object(o)).forEach((function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(o,r))}))}return t}function ConnectionSettings_defineProperty(t,r,o){return r in t?Object.defineProperty(t,r,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[r]=o,t}function ConnectionSettings_defineProperties(t,r){for(var o=0;o<r.length;o++){var i=r[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var g=function(){function ConnectionSettings(){!function ConnectionSettings_classCallCheck(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}(this,ConnectionSettings),this.contentType="application/json",this.mode="cors",this.cache="no-cache",this.headers={},this.baseUrl="http://localhost"}return function ConnectionSettings_createClass(t,r,o){return r&&ConnectionSettings_defineProperties(t.prototype,r),o&&ConnectionSettings_defineProperties(t,o),t}(ConnectionSettings,[{key:"setBaseUrl",value:function setBaseUrl(t){return this.baseUrl=null!=t?t:"http://localhost",this}},{key:"getBaseUrl",value:function getBaseUrl(){return this.baseUrl}},{key:"getSettings",value:function getSettings(){return{mode:this.mode,cache:this.cache,headers:ConnectionSettings_objectSpread({Accept:this.contentType,"Content-Type":this.contentType},this.headers),redirect:"follow",referrerPolicy:"no-referrer"}}}]),ConnectionSettings}();function ConnectionAdapter_defineProperties(t,r){for(var o=0;o<r.length;o++){var i=r[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var b=function(){function ConnectionAdapter(t){!function ConnectionAdapter_classCallCheck(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}(this,ConnectionAdapter),this.connectionSettings=t instanceof g?t:(new g).setBaseUrl(t.url)}return function ConnectionAdapter_createClass(t,r,o){return r&&ConnectionAdapter_defineProperties(t.prototype,r),o&&ConnectionAdapter_defineProperties(t,o),t}(ConnectionAdapter,[{key:"load",value:function load(t){throw new Error("should be extended")}},{key:"all",value:function all(t){throw new Error("should be extended")}},{key:"get",value:function get(t){throw new Error("should be extended")}},{key:"put",value:function put(t){throw new Error("should be extended")}},{key:"patch",value:function patch(t){throw new Error("should be extended")}},{key:"post",value:function post(t){throw new Error("should be extended")}},{key:"delete",value:function _delete(t){throw new Error("should be extended")}}]),ConnectionAdapter}();function QueueMessage_defineProperties(t,r){for(var o=0;o<r.length;o++){var i=r[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var v=function(){function QueueMessage(t,r,o){!function QueueMessage_classCallCheck(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}(this,QueueMessage),this.model=t,this.action=r,this.data=o}return function QueueMessage_createClass(t,r,o){return r&&QueueMessage_defineProperties(t.prototype,r),o&&QueueMessage_defineProperties(t,o),t}(QueueMessage,[{key:"addCallback",value:function addCallback(t){this.callback=t}},{key:"execute",value:function execute(){var t;this.model[this.action](this.data),(null!==(t=this.callback)&&void 0!==t?t:function(){})()}}]),QueueMessage}();function ConnectionRequest_ownKeys(t,r){var o=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);r&&(i=i.filter((function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable}))),o.push.apply(o,i)}return o}function ConnectionRequest_objectSpread(t){for(var r=1;r<arguments.length;r++){var o=null!=arguments[r]?arguments[r]:{};r%2?ConnectionRequest_ownKeys(Object(o),!0).forEach((function(r){ConnectionRequest_defineProperty(t,r,o[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):ConnectionRequest_ownKeys(Object(o)).forEach((function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(o,r))}))}return t}function ConnectionRequest_defineProperty(t,r,o){return r in t?Object.defineProperty(t,r,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[r]=o,t}function ConnectionRequest_defineProperties(t,r){for(var o=0;o<r.length;o++){var i=r[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var m=function(){function ConnectionRequest(t){!function ConnectionRequest_classCallCheck(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}(this,ConnectionRequest),this.connectionRequestSettings=t}return function ConnectionRequest_createClass(t,r,o){return r&&ConnectionRequest_defineProperties(t.prototype,r),o&&ConnectionRequest_defineProperties(t,o),t}(ConnectionRequest,[{key:"modelApiLocation",value:function modelApiLocation(t){return"".concat(this.connectionRequestSettings.getBaseUrl(),"/").concat(t.kebabCaseClassName)}},{key:"post",value:function post(t){return console.log(t.toJson()),fetch(this.modelApiLocation(t),ConnectionRequest_objectSpread({method:"POST",body:JSON.stringify(t.toJson())},this.connectionRequestSettings.getSettings()))}},{key:"all",value:function all(t){return fetch("".concat(this.modelApiLocation(t)),ConnectionRequest_objectSpread({method:"GET"},this.connectionRequestSettings.getSettings()))}},{key:"get",value:function get(t){return fetch("".concat(this.modelApiLocation(t),"/").concat(t.primaryKey),ConnectionRequest_objectSpread({method:"GET"},this.connectionRequestSettings.getSettings()))}},{key:"patch",value:function patch(t){return fetch("".concat(this.modelApiLocation(t),"/").concat(t.primaryKey),ConnectionRequest_objectSpread({method:"PATCH",body:JSON.stringify(t.dirtyFields)},this.connectionRequestSettings.getSettings()))}},{key:"put",value:function put(t){return fetch("".concat(this.modelApiLocation(t),"/"),ConnectionRequest_objectSpread({method:"PUT",body:JSON.stringify(t.toJson())},this.connectionRequestSettings.getSettings()))}},{key:"delete",value:function _delete(t){return fetch("".concat(this.modelApiLocation(t),"/").concat(t.primaryKey),ConnectionRequest_objectSpread({method:"DELETE"},this.connectionRequestSettings.getSettings()))}}]),ConnectionRequest}();function ConnectionAdapterJsonRequest_typeof(t){return(ConnectionAdapterJsonRequest_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(t){return typeof t}:function _typeof(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ConnectionAdapterJsonRequest_defineProperties(t,r){for(var o=0;o<r.length;o++){var i=r[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function ConnectionAdapterJsonRequest_setPrototypeOf(t,r){return(ConnectionAdapterJsonRequest_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(t,r){return t.__proto__=r,t})(t,r)}function ConnectionAdapterJsonRequest_createSuper(t){var r=function ConnectionAdapterJsonRequest_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var o,i=ConnectionAdapterJsonRequest_getPrototypeOf(t);if(r){var a=ConnectionAdapterJsonRequest_getPrototypeOf(this).constructor;o=Reflect.construct(i,arguments,a)}else o=i.apply(this,arguments);return ConnectionAdapterJsonRequest_possibleConstructorReturn(this,o)}}function ConnectionAdapterJsonRequest_possibleConstructorReturn(t,r){return!r||"object"!==ConnectionAdapterJsonRequest_typeof(r)&&"function"!=typeof r?function ConnectionAdapterJsonRequest_assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):r}function ConnectionAdapterJsonRequest_getPrototypeOf(t){return(ConnectionAdapterJsonRequest_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var O=function(t){!function ConnectionAdapterJsonRequest_inherits(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),r&&ConnectionAdapterJsonRequest_setPrototypeOf(t,r)}(ConnectionAdapterJsonRequest,t);var r=ConnectionAdapterJsonRequest_createSuper(ConnectionAdapterJsonRequest);function ConnectionAdapterJsonRequest(t){return function ConnectionAdapterJsonRequest_classCallCheck(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}(this,ConnectionAdapterJsonRequest),r.call(this,t)}return function ConnectionAdapterJsonRequest_createClass(t,r,o){return r&&ConnectionAdapterJsonRequest_defineProperties(t.prototype,r),o&&ConnectionAdapterJsonRequest_defineProperties(t,o),t}(ConnectionAdapterJsonRequest,[{key:"load",value:function load(t){return this.all(t)}},{key:"responseJson",value:function responseJson(t){return t.json()}},{key:"all",value:function all(t){var r=this;return new Promise((function(o){new m(r.connectionSettings).all(t).then((function(t){return r.responseJson(t)})).then((function(r){var i=new v(t,"insert",r);o(i)}))}))}},{key:"get",value:function get(t){var r=this;return new Promise((function(o){new m(r.connectionSettings).get(t).then((function(t){return r.responseJson(t)})).then((function(r){var i=new v(t,"fill",r);o(i)}))}))}},{key:"post",value:function post(t){var r=this;return new Promise((function(o){new m(r.connectionSettings).post(t).then((function(t){return r.responseJson(t)})).then((function(r){var i=new v(t,"fill",r);o(i)}))}))}},{key:"put",value:function put(t){var r=this;return new Promise((function(o){new m(r.connectionSettings).put(t).then((function(t){return r.responseJson(t)})).then((function(r){var i=new v(t,"fill",r);o(i)}))}))}},{key:"patch",value:function patch(t){var r=this;return new Promise((function(o){new m(r.connectionSettings).patch(t).then((function(t){return r.responseJson(t)})).then((function(r){var i=new v(t,"fill",r);o(i)}))}))}},{key:"delete",value:function _delete(t){var r=this;return new Promise((function(o){new m(r.connectionSettings).delete(t).then((function(t){return r.responseJson(t)})).then((function(r){var i=new v(t,"delete",r);o(i)}))}))}},{key:"isRemote",get:function get(){return!0}},{key:"isLocal",get:function get(){return!1}}]),ConnectionAdapterJsonRequest}(b);function ConnectionAdapterLocalStorage_typeof(t){return(ConnectionAdapterLocalStorage_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(t){return typeof t}:function _typeof(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ConnectionAdapterLocalStorage_defineProperties(t,r){for(var o=0;o<r.length;o++){var i=r[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function ConnectionAdapterLocalStorage_setPrototypeOf(t,r){return(ConnectionAdapterLocalStorage_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(t,r){return t.__proto__=r,t})(t,r)}function ConnectionAdapterLocalStorage_createSuper(t){var r=function ConnectionAdapterLocalStorage_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var o,i=ConnectionAdapterLocalStorage_getPrototypeOf(t);if(r){var a=ConnectionAdapterLocalStorage_getPrototypeOf(this).constructor;o=Reflect.construct(i,arguments,a)}else o=i.apply(this,arguments);return ConnectionAdapterLocalStorage_possibleConstructorReturn(this,o)}}function ConnectionAdapterLocalStorage_possibleConstructorReturn(t,r){return!r||"object"!==ConnectionAdapterLocalStorage_typeof(r)&&"function"!=typeof r?function ConnectionAdapterLocalStorage_assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):r}function ConnectionAdapterLocalStorage_getPrototypeOf(t){return(ConnectionAdapterLocalStorage_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var C=function(t){!function ConnectionAdapterLocalStorage_inherits(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),r&&ConnectionAdapterLocalStorage_setPrototypeOf(t,r)}(ConnectionAdapterLocalArray,t);var r=ConnectionAdapterLocalStorage_createSuper(ConnectionAdapterLocalArray);function ConnectionAdapterLocalArray(t){return function ConnectionAdapterLocalStorage_classCallCheck(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}(this,ConnectionAdapterLocalArray),r.call(this,t)}return function ConnectionAdapterLocalStorage_createClass(t,r,o){return r&&ConnectionAdapterLocalStorage_defineProperties(t.prototype,r),o&&ConnectionAdapterLocalStorage_defineProperties(t,o),t}(ConnectionAdapterLocalArray,[{key:"load",value:function load(t){var r=this;return new Promise((function(o){o(new v(t,"aSyncInsert",r.getTableFromLocalStorage(t)))}))}},{key:"getLocalStorageKey",value:function getLocalStorageKey(t){return"jeloquent-".concat(globalThis.Store.use,"-").concat(t.className)}},{key:"getTableFromLocalStorage",value:function getTableFromLocalStorage(t){var r;return JSON.parse(null!==(r=localStorage.getItem(this.getLocalStorageKey(t)))&&void 0!==r?r:"[]")}},{key:"post",value:function post(t,r){localStorage.setItem(this.getLocalStorageKey(t),JSON.stringify(r))}}]),ConnectionAdapterLocalArray}(b);function ConnectionAdapterFactory_defineProperties(t,r){for(var o=0;o<r.length;o++){var i=r[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var P=function(){function ConnectionAdapterFactory(){!function ConnectionAdapterFactory_classCallCheck(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}(this,ConnectionAdapterFactory)}return function ConnectionAdapterFactory_createClass(t,r,o){return r&&ConnectionAdapterFactory_defineProperties(t.prototype,r),o&&ConnectionAdapterFactory_defineProperties(t,o),t}(ConnectionAdapterFactory,null,[{key:"getAdapter",value:function getAdapter(t,r){return"jsonRequest"===t?new O(r):"localStorage"===t||"localArray"===t?new C(r):new O(r)}}]),ConnectionAdapterFactory}();function Connection_defineProperties(t,r){for(var o=0;o<r.length;o++){var i=r[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var k=function(){function Connection(t,r){!function Connection_classCallCheck(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}(this,Connection),this.adapter=t instanceof b?t:P.getAdapter(t,r),this.updateQueue=[],this.paused=!1}return function Connection_createClass(t,r,o){return r&&Connection_defineProperties(t.prototype,r),o&&Connection_defineProperties(t,o),t}(Connection,[{key:"processQueue",value:function processQueue(){var t,r=this,o=(null!==(t=this.updateQueue)&&void 0!==t?t:[]).shift();o&&(o.execute(),setTimeout((function(){r.processQueue()}),1))}},{key:"addToQueue",value:function addToQueue(){var t;(t=this.updateQueue).push.apply(t,arguments)}},{key:"pause",value:function pause(){this.paused=!0}},{key:"resume",value:function resume(){this.paused=!1}},{key:"load",value:function load(t){return this.all(t)}},{key:"all",value:function all(t){var r=this;return new Promise((function(o){r.adapter.all(t).then((function(t){t.addCallback(o),r.addToQueue(t),setTimeout((function(){r.processQueue()}),1)}))}))}},{key:"post",value:function post(t){var r=this;return new Promise((function(o){r.adapter.post(t).then((function(t){t.addCallback(o),r.addToQueue(t),setTimeout((function(){r.processQueue()}),1)}))}))}},{key:"put",value:function put(t){var r=this;return new Promise((function(o){r.adapter.put(t).then((function(t){t.addCallback(o),r.addToQueue(t),setTimeout((function(){r.processQueue()}),1)}))}))}},{key:"patch",value:function patch(t){var r=this;return new Promise((function(o){r.adapter.patch(t).then((function(t){t.addCallback(o),r.addToQueue(t),setTimeout((function(){r.processQueue()}),1)}))}))}},{key:"delete",value:function _delete(t){var r=this;return new Promise((function(o){r.adapter.delete(t).then((function(t){t.addCallback(o),r.addToQueue(t),setTimeout((function(){r.processQueue()}),1)}))}))}}]),Connection}();function Store_defineProperties(t,r){for(var o=0;o<r.length;o++){var i=r[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var S=function(){function Store(){!function Store_classCallCheck(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}(this,Store),this.classInstances={},this.databases={},this.connetions={},this.numberOfModelCreated=0,this.useDatabase="default",this.useConnection="default",globalThis.Store=this}return function Store_createClass(t,r,o){return r&&Store_defineProperties(t.prototype,r),o&&Store_defineProperties(t,o),t}(Store,[{key:"use",value:function use(t){var r,o;this.useDatabase=t,null===(r=this.databases[null!==(o=this.useDatabase)&&void 0!==o?o:"default"])||void 0===r||r.setIndexes()}},{key:"add",value:function add(t){this.databases[t.name]=t}},{key:"addConnections",value:function addConnections(t,r){this.connetions[null!=r?r:"default"]=t}},{key:"useConnection",value:function useConnection(t){this.useConnection=null!=t?t:"default"}},{key:"database",value:function database(){var t;return null!==(t=this.databases[this.useDatabase])&&void 0!==t?t:null}},{key:"connection",value:function connection(){return this.connetions[this.useConnection]}}]),Store}();function BelongTo_typeof(t){return(BelongTo_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(t){return typeof t}:function _typeof(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function BelongTo_createForOfIteratorHelper(t,r){var o;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(o=function BelongTo_unsupportedIterableToArray(t,r){if(!t)return;if("string"==typeof t)return BelongTo_arrayLikeToArray(t,r);var o=Object.prototype.toString.call(t).slice(8,-1);"Object"===o&&t.constructor&&(o=t.constructor.name);if("Map"===o||"Set"===o)return Array.from(t);if("Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o))return BelongTo_arrayLikeToArray(t,r)}(t))||r&&t&&"number"==typeof t.length){o&&(t=o);var i=0,a=function F(){};return{s:a,n:function n(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function e(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var u,l=!0,c=!1;return{s:function s(){o=t[Symbol.iterator]()},n:function n(){var t=o.next();return l=t.done,t},e:function e(t){c=!0,u=t},f:function f(){try{l||null==o.return||o.return()}finally{if(c)throw u}}}}function BelongTo_arrayLikeToArray(t,r){(null==r||r>t.length)&&(r=t.length);for(var o=0,i=new Array(r);o<r;o++)i[o]=t[o];return i}function BelongTo_defineProperties(t,r){for(var o=0;o<r.length;o++){var i=r[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function _get(t,r,o){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(t,r,o){var i=function _superPropBase(t,r){for(;!Object.prototype.hasOwnProperty.call(t,r)&&null!==(t=BelongTo_getPrototypeOf(t)););return t}(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(o):a.value}})(t,r,o||t)}function BelongTo_setPrototypeOf(t,r){return(BelongTo_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(t,r){return t.__proto__=r,t})(t,r)}function BelongTo_createSuper(t){var r=function BelongTo_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var o,i=BelongTo_getPrototypeOf(t);if(r){var a=BelongTo_getPrototypeOf(this).constructor;o=Reflect.construct(i,arguments,a)}else o=i.apply(this,arguments);return BelongTo_possibleConstructorReturn(this,o)}}function BelongTo_possibleConstructorReturn(t,r){return!r||"object"!==BelongTo_typeof(r)&&"function"!=typeof r?function BelongTo_assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):r}function BelongTo_getPrototypeOf(t){return(BelongTo_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var w=function(t){!function BelongTo_inherits(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),r&&BelongTo_setPrototypeOf(t,r)}(BelongsTo,t);var r=BelongTo_createSuper(BelongsTo);function BelongsTo(t,o,i){return function BelongTo_classCallCheck(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}(this,BelongsTo),r.call(this,t,null!=o?o:"".concat(t.snakeCaseClassName,"_id"),i)}return function BelongTo_createClass(t,r,o){return r&&BelongTo_defineProperties(t.prototype,r),o&&BelongTo_defineProperties(t,o),t}(BelongsTo,[{key:"setName",value:function setName(){var t,r=this.model.snakeCaseClassName;return this.$name=null!==(t=this.$name)&&void 0!==t?t:"".concat(r),this}},{key:"setParentProperties",value:function setParentProperties(){var t=this;_get(BelongTo_getPrototypeOf(BelongsTo.prototype),"setParentProperties",this).call(this);var r,o="",i=BelongTo_createForOfIteratorHelper(this.$name.split("_"));try{for(i.s();!(r=i.n()).done;){var a=r.value;o+=a[0].toUpperCase()+a.slice(1)}}catch(t){i.e(t)}finally{i.f()}return Object.defineProperty(this.$parent,"has".concat(o),{get:function get(){return null!==t.value}}),this}},{key:"value",get:function get(){return this.model.find(this.$parent[this.foreignKey])},set:function set(t){}},{key:"originalValue",get:function get(){return this.model.find(this.$parent["original_".concat(this.foreignKey)])}}]),BelongsTo}(u);function HasOne_typeof(t){return(HasOne_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(t){return typeof t}:function _typeof(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function HasOne_toConsumableArray(t){return function HasOne_arrayWithoutHoles(t){if(Array.isArray(t))return HasOne_arrayLikeToArray(t)}(t)||function HasOne_iterableToArray(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function HasOne_unsupportedIterableToArray(t,r){if(!t)return;if("string"==typeof t)return HasOne_arrayLikeToArray(t,r);var o=Object.prototype.toString.call(t).slice(8,-1);"Object"===o&&t.constructor&&(o=t.constructor.name);if("Map"===o||"Set"===o)return Array.from(t);if("Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o))return HasOne_arrayLikeToArray(t,r)}(t)||function HasOne_nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function HasOne_arrayLikeToArray(t,r){(null==r||r>t.length)&&(r=t.length);for(var o=0,i=new Array(r);o<r;o++)i[o]=t[o];return i}function HasOne_defineProperties(t,r){for(var o=0;o<r.length;o++){var i=r[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function HasOne_get(t,r,o){return(HasOne_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(t,r,o){var i=function HasOne_superPropBase(t,r){for(;!Object.prototype.hasOwnProperty.call(t,r)&&null!==(t=HasOne_getPrototypeOf(t)););return t}(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(o):a.value}})(t,r,o||t)}function HasOne_setPrototypeOf(t,r){return(HasOne_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(t,r){return t.__proto__=r,t})(t,r)}function HasOne_createSuper(t){var r=function HasOne_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var o,i=HasOne_getPrototypeOf(t);if(r){var a=HasOne_getPrototypeOf(this).constructor;o=Reflect.construct(i,arguments,a)}else o=i.apply(this,arguments);return HasOne_possibleConstructorReturn(this,o)}}function HasOne_possibleConstructorReturn(t,r){return!r||"object"!==HasOne_typeof(r)&&"function"!=typeof r?function HasOne_assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):r}function HasOne_getPrototypeOf(t){return(HasOne_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var T=function(t){!function HasOne_inherits(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),r&&HasOne_setPrototypeOf(t,r)}(HasOne,t);var r=HasOne_createSuper(HasOne);function HasOne(t){return function HasOne_classCallCheck(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}(this,HasOne),r.call(this,t)}return function HasOne_createClass(t,r,o){return r&&HasOne_defineProperties(t.prototype,r),o&&HasOne_defineProperties(t,o),t}(HasOne,[{key:"getValueByParentKey",value:function getValueByParentKey(t){var r,o,i=this.model.getIndexByKey(this.foreignKey);return globalThis.Store.database().find(this.model.className,HasOne_toConsumableArray(null!==(r=null===(o=i.get(this.$parent[t]))||void 0===o?void 0:o.values())&&void 0!==r?r:[])).first()}},{key:"setName",value:function setName(){return this.foreignKey="".concat(this.$parent.snakeCaseClassName,"_id"),this}},{key:"getRelationalFields",value:function getRelationalFields(){return[]}},{key:"setParentProperties",value:function setParentProperties(){var t=this;return HasOne_get(HasOne_getPrototypeOf(HasOne.prototype),"setParentProperties",this).call(this),Object.defineProperty(this.$parent,"has".concat(this.model.className),{get:function get(){return null!==t.value}}),this}},{key:"value",get:function get(){return this.getValueByParentKey("primaryKey")}},{key:"originalValue",get:function get(){return this.getValueByParentKey("originalPrimaryKey")}}]),HasOne}(u);function HasMany_typeof(t){return(HasMany_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(t){return typeof t}:function _typeof(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function HasMany_toConsumableArray(t){return function HasMany_arrayWithoutHoles(t){if(Array.isArray(t))return HasMany_arrayLikeToArray(t)}(t)||function HasMany_iterableToArray(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function HasMany_unsupportedIterableToArray(t,r){if(!t)return;if("string"==typeof t)return HasMany_arrayLikeToArray(t,r);var o=Object.prototype.toString.call(t).slice(8,-1);"Object"===o&&t.constructor&&(o=t.constructor.name);if("Map"===o||"Set"===o)return Array.from(t);if("Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o))return HasMany_arrayLikeToArray(t,r)}(t)||function HasMany_nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function HasMany_arrayLikeToArray(t,r){(null==r||r>t.length)&&(r=t.length);for(var o=0,i=new Array(r);o<r;o++)i[o]=t[o];return i}function HasMany_defineProperties(t,r){for(var o=0;o<r.length;o++){var i=r[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function HasMany_get(t,r,o){return(HasMany_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(t,r,o){var i=function HasMany_superPropBase(t,r){for(;!Object.prototype.hasOwnProperty.call(t,r)&&null!==(t=HasMany_getPrototypeOf(t)););return t}(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(o):a.value}})(t,r,o||t)}function HasMany_setPrototypeOf(t,r){return(HasMany_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(t,r){return t.__proto__=r,t})(t,r)}function HasMany_createSuper(t){var r=function HasMany_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var o,i=HasMany_getPrototypeOf(t);if(r){var a=HasMany_getPrototypeOf(this).constructor;o=Reflect.construct(i,arguments,a)}else o=i.apply(this,arguments);return HasMany_possibleConstructorReturn(this,o)}}function HasMany_possibleConstructorReturn(t,r){return!r||"object"!==HasMany_typeof(r)&&"function"!=typeof r?function HasMany_assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):r}function HasMany_getPrototypeOf(t){return(HasMany_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var R=function(t){!function HasMany_inherits(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),r&&HasMany_setPrototypeOf(t,r)}(HasMany,t);var r=HasMany_createSuper(HasMany);function HasMany(t,o,i){var a;return function HasMany_classCallCheck(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}(this,HasMany),(a=r.call(this,t,o)).localKey=null!=i?i:"id",a}return function HasMany_createClass(t,r,o){return r&&HasMany_defineProperties(t.prototype,r),o&&HasMany_defineProperties(t,o),t}(HasMany,[{key:"getValueByParentKey",value:function getValueByParentKey(t){var r,o,i=this.model.getIndexByKey(this.foreignKey);return globalThis.Store.database().find(this.model.className,HasMany_toConsumableArray(null!==(r=null===(o=i.get(this.$parent[t]))||void 0===o?void 0:o.values())&&void 0!==r?r:[]))}},{key:"setName",value:function setName(){var t=this.$parent.snakeCaseClassName,r=this.model.snakeCaseClassName;return this.foreignKey="".concat(t,"_id"),this.$name="".concat(r,"s"),this}},{key:"getRelationalFields",value:function getRelationalFields(){return[]}},{key:"setParentProperties",value:function setParentProperties(){var t=this;return HasMany_get(HasMany_getPrototypeOf(HasMany.prototype),"setParentProperties",this).call(this),Object.defineProperty(this.$parent,"".concat(this.$name,"Count"),{get:function get(){return t.count}}),Object.defineProperty(this.$parent,"has".concat(this.model.className,"s"),{get:function get(){return t.count>0}}),this}},{key:"count",get:function get(){var t,r;return null!==(t=null===(r=globalThis.Store.database().indexes(this.model.className).get(this.foreignKey).get(this.$parent.primaryKey))||void 0===r?void 0:r.size)&&void 0!==t?t:0}},{key:"value",get:function get(){return this.getValueByParentKey("primaryKey")}},{key:"originalValue",get:function get(){return this.getValueByParentKey("originalPrimaryKey")}}]),HasMany}(u);function HasOneThrough_typeof(t){return(HasOneThrough_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(t){return typeof t}:function _typeof(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function HasOneThrough_defineProperties(t,r){for(var o=0;o<r.length;o++){var i=r[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function HasOneThrough_setPrototypeOf(t,r){return(HasOneThrough_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(t,r){return t.__proto__=r,t})(t,r)}function HasOneThrough_createSuper(t){var r=function HasOneThrough_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var o,i=HasOneThrough_getPrototypeOf(t);if(r){var a=HasOneThrough_getPrototypeOf(this).constructor;o=Reflect.construct(i,arguments,a)}else o=i.apply(this,arguments);return HasOneThrough_possibleConstructorReturn(this,o)}}function HasOneThrough_possibleConstructorReturn(t,r){return!r||"object"!==HasOneThrough_typeof(r)&&"function"!=typeof r?function HasOneThrough_assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):r}function HasOneThrough_getPrototypeOf(t){return(HasOneThrough_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var A=function(t){!function HasOneThrough_inherits(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),r&&HasOneThrough_setPrototypeOf(t,r)}(HasOneThrough,t);var r=HasOneThrough_createSuper(HasOneThrough);function HasOneThrough(t,o,i,a){var u;return function HasOneThrough_classCallCheck(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}(this,HasOneThrough),(u=r.call(this,t,i)).throughModel=o,u.localKey=null!=a?a:"id",u}return function HasOneThrough_createClass(t,r,o){return r&&HasOneThrough_defineProperties(t.prototype,r),o&&HasOneThrough_defineProperties(t,o),t}(HasOneThrough,[{key:"setName",value:function setName(){return this._lcThroughModelClassName=this.throughModel.snakeCaseClassName,this._lcModelClassName=this.model.snakeCaseClassName,this._lcParentClassName=this.$parent.snakeCaseClassName,this.foreignKey="".concat(this._lcThroughModelClassName,"_id"),this.$name="".concat(this._lcModelClassName),this}},{key:"getRelationalFields",value:function getRelationalFields(){return[]}},{key:"value",get:function get(){var t;return null!==(t=this.$parent[this._lcThroughModelClassName][this._lcModelClassName])&&void 0!==t?t:null}},{key:"originalValue",get:function get(){var t;return null!==(t=this.$parent["original_".concat(this._lcThroughModelClassName)]["original_".concat(this._lcModelClassName)])&&void 0!==t?t:null}},{key:"indexName",get:function get(){return"".concat(this._lcThroughModelClassName,".").concat(this._lcParentClassName,"_id")}}]),HasOneThrough}(u);function MorphOne_typeof(t){return(MorphOne_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(t){return typeof t}:function _typeof(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function MorphOne_defineProperties(t,r){for(var o=0;o<r.length;o++){var i=r[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function MorphOne_setPrototypeOf(t,r){return(MorphOne_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(t,r){return t.__proto__=r,t})(t,r)}function MorphOne_createSuper(t){var r=function MorphOne_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var o,i=MorphOne_getPrototypeOf(t);if(r){var a=MorphOne_getPrototypeOf(this).constructor;o=Reflect.construct(i,arguments,a)}else o=i.apply(this,arguments);return MorphOne_possibleConstructorReturn(this,o)}}function MorphOne_possibleConstructorReturn(t,r){return!r||"object"!==MorphOne_typeof(r)&&"function"!=typeof r?function MorphOne_assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):r}function MorphOne_getPrototypeOf(t){return(MorphOne_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var M=function(t){!function MorphOne_inherits(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),r&&MorphOne_setPrototypeOf(t,r)}(MorphOne,t);var r=MorphOne_createSuper(MorphOne);function MorphOne(t){return function MorphOne_classCallCheck(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}(this,MorphOne),r.call(this,t)}return function MorphOne_createClass(t,r,o){return r&&MorphOne_defineProperties(t.prototype,r),o&&MorphOne_defineProperties(t,o),t}(MorphOne,[{key:"getValueByParentKey",value:function getValueByParentKey(t){var r=this.$parent.className,o=this.$parent[t],i="".concat(this.$name,"_id"),a="".concat(this.$name,"_type"),u={};return u[i]=o,u[a]=r,this.model.find(u)}},{key:"getRelationalFields",value:function getRelationalFields(){return[]}},{key:"value",get:function get(){return this.getValueByParentKey("primaryKey")}},{key:"originalValue",get:function get(){return this.getValueByParentKey("originalPrimaryKey")}}]),MorphOne}(u);function MorphTo_typeof(t){return(MorphTo_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(t){return typeof t}:function _typeof(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function MorphTo_createForOfIteratorHelper(t,r){var o;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(o=function MorphTo_unsupportedIterableToArray(t,r){if(!t)return;if("string"==typeof t)return MorphTo_arrayLikeToArray(t,r);var o=Object.prototype.toString.call(t).slice(8,-1);"Object"===o&&t.constructor&&(o=t.constructor.name);if("Map"===o||"Set"===o)return Array.from(t);if("Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o))return MorphTo_arrayLikeToArray(t,r)}(t))||r&&t&&"number"==typeof t.length){o&&(t=o);var i=0,a=function F(){};return{s:a,n:function n(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function e(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var u,l=!0,c=!1;return{s:function s(){o=t[Symbol.iterator]()},n:function n(){var t=o.next();return l=t.done,t},e:function e(t){c=!0,u=t},f:function f(){try{l||null==o.return||o.return()}finally{if(c)throw u}}}}function MorphTo_arrayLikeToArray(t,r){(null==r||r>t.length)&&(r=t.length);for(var o=0,i=new Array(r);o<r;o++)i[o]=t[o];return i}function MorphTo_defineProperties(t,r){for(var o=0;o<r.length;o++){var i=r[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function MorphTo_setPrototypeOf(t,r){return(MorphTo_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(t,r){return t.__proto__=r,t})(t,r)}function MorphTo_createSuper(t){var r=function MorphTo_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var o,i=MorphTo_getPrototypeOf(t);if(r){var a=MorphTo_getPrototypeOf(this).constructor;o=Reflect.construct(i,arguments,a)}else o=i.apply(this,arguments);return MorphTo_possibleConstructorReturn(this,o)}}function MorphTo_possibleConstructorReturn(t,r){return!r||"object"!==MorphTo_typeof(r)&&"function"!=typeof r?function MorphTo_assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):r}function MorphTo_getPrototypeOf(t){return(MorphTo_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var j=function(t){!function MorphTo_inherits(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),r&&MorphTo_setPrototypeOf(t,r)}(MorphTo,t);var r=MorphTo_createSuper(MorphTo);function MorphTo(t){return function MorphTo_classCallCheck(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}(this,MorphTo),r.call(this,t)}return function MorphTo_createClass(t,r,o){return r&&MorphTo_defineProperties(t.prototype,r),o&&MorphTo_defineProperties(t,o),t}(MorphTo,[{key:"setFillPropertyOnParent",value:function setFillPropertyOnParent(){var t=this;Object.defineProperty(this.$parent,"_".concat(this.$name),{set:function set(r){Array.isArray(r)||(r=[r]);var o,i=t.$parent.snakeCaseClassName,a="".concat(i,"_type"),u="".concat(i,"_id"),l=MorphTo_createForOfIteratorHelper(r);try{for(l.s();!(o=l.n()).done;){var c=o.value;c.id=c[u],globalThis.Store.classInstances[c[a]].constructor.insert(c)}}catch(t){l.e(t)}finally{l.f()}}})}},{key:"value",get:function get(){var t=this.$parent.snakeCaseClassName,r=this.$parent["".concat(t,"_type")],o=this.$parent["".concat(t,"_id")];return globalThis.Store.classInstances[r].constructor.find(o)}}]),MorphTo}(i)}},r={};function __webpack_require__(o){if(r[o])return r[o].exports;var i=r[o]={exports:{}};return t[o](i,i.exports,__webpack_require__),i.exports}return __webpack_require__.d=(t,r)=>{for(var o in r)__webpack_require__.o(r,o)&&!__webpack_require__.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:r[o]})},__webpack_require__.o=(t,r)=>Object.prototype.hasOwnProperty.call(t,r),__webpack_require__.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},__webpack_require__(486)})()}));